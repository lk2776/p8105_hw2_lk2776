---
title: "p8105_hw2_lk2776"
output: github_document
date: "2024-09-30"
---

```{r setup, warning=FALSE, message=FALSE}
#load packages; print 3 lines of tibble output
library(tidyverse)
library(readxl)
options(tibble.print_min=5)

```

## problem1:

The cleaned NYC dataset contains line, station_name, station_latitude, station_longitude, routes1-11, entry, vending, entrance_type, ada variables. The cleaning process involved reading the data with missing value using na(), reading the columns route8-11 as character columns using col_types(), cleaning the column names using janitor::clean_names(), selecting the desired columns using select(), and converting entry variable using mutate() and ifelse() functions. The resulting dataset has 19 columns and 1868 rows. The data is not tidy because routes1-11 can be put together in two columns: route_name and route_value. 

- 465 distinct stations in the dataset. 
- 468 stations are ada compliant.
- ~38% of stations with vending allow entrance.

- 91 distinct stations serve the A train after data is reformatted so that route number and name are distinct variables. 
- of the 91 distinct stations that serve the A train, only 34 stations are ADA compliant. 


```{r study data}
#read data using read_csv() from tidyverse
nyc_data = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", 
                    na=c("NA",".",""), 
                    col_names = TRUE, 
                    col_types = cols(
                      Route8=col_character(),
                      Route9=col_character(), 
                      Route10=col_character(),
                      Route11=col_character())) |>
  #clean column names
  janitor::clean_names() |> 
  #select columns 
  select(line,station_name,station_latitude,station_longitude,
         entry,vending,entrance_type,ada,
         route1,route2,route3,route4,route5,
         route6,route7,route8,route9,route10,route11
         ) |> 
  #convert entry column from character to logical vector
  mutate(entry=if_else(entry %in%"YES",TRUE,FALSE))

#check class of columns of dataset to verify entry varible class
nyc_data |> sapply(class)

#check dimensions of dataset
dim_desc(nyc_data)

```

```{r answering specific questions}
#number of distinct line_station_names
nyc_data |> select(line,station_name)  |>
  unite("line_station_name", line:station_name) |> 
 n_distinct() 
   
#number of stations that are ada compliant
table(nyc_data$ada)

#proportion of stations with entry but with out vending
#table(nyc_data$vending) #183 NO
nyc_data |> select(entry, vending) |> 
  filter(vending %in% "NO") |>
  table()
69/183
  
```

```{r answering more questions}
#number of distinct stations with route "A"
nyc_data |> pivot_longer(
  route1:route11, 
  names_to="route_number",
  values_to="route_name"
) |>
  filter(route_name == "A") |> 
  unite("line_station_name", line:station_name) |> 
  n_distinct()

#number of distinct stations with route "A" and ada compliant
nyc_data |> pivot_longer(
  route1:route11, 
  names_to="route_number",
  values_to="route_name"
) |>
  filter(route_name == "A") |> 
  filter(ada=="TRUE") |> 
unite("line_station_name", line:station_name) |> 
  n_distinct()
```

----------------------------------------------
## problem 2
#[653 x 14]" 
 "[651 x 15]" [119 x 14]" "[263 x 13]"

```{r}
mr_trash_wheel = readxl::read_excel("./data/202409_Trash_Wheel_Collection_Data.xlsx",
                            sheet = "Mr. Trash Wheel", 
                            col_names=TRUE,na="") |>
  select(-"...15",-"...16") |>
  janitor::clean_names() |>
  drop_na(dumpster) |> 
  mutate(sports_balls = as.integer(round(sports_balls),digits=0)) |>
  mutate(wheel_name = "mr_trash_wheel")
  
dim_desc(mr_trash_wheel)
```

```{r}
prof_trash_wheel = readxl::read_excel("./data/202409_Trash_Wheel_Collection_Data.xlsx",
                            sheet = "Professor Trash Wheel", col_names=TRUE,na="") |>
  janitor::clean_names() |>
  drop_na(dumpster) |> 
  mutate(year=as.character(year)) |> 
  mutate(wheel_name = "prof_trash_wheel")

dim_desc(prof_trash_wheel)
```

```{r}
g_trash_wheel = readxl::read_excel("./data/202409_Trash_Wheel_Collection_Data.xlsx",
                            sheet = "Gwynnda Trash Wheel", col_names=TRUE,na="") |>
  janitor::clean_names() |>
  drop_na(dumpster) |>
  mutate(year=as.character(year)) |> 
  mutate(wheel_name = "g_trash_wheel")

dim_desc(g_trash_wheel)
```

```{r}
lotr_tidy = 
  dplyr::bind_rows(mr_trash_wheel, prof_trash_wheel, g_trash_wheel) 
```

|>
  pivot_longer(
    female:male,
    names_to = "gender", 
    values_to = "words") |>
  mutate(race = str_to_lower(race)) |> 
  select(movie, everything()) 
  
  
